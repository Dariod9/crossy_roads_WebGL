<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Crossy Road - CV </title>
        <!-- Favicon-->
        <link rel="icon" type="image/x-icon" href="assets/img/favicon.ico" />
        <!-- Font Awesome icons (free version)-->
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Merriweather+Sans:400,700" rel="stylesheet" />
        <link href="https://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic" rel="stylesheet" type="text/css" />
        <!-- Third party plugin CSS-->
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="css/styles.css" rel="stylesheet" />
        <style>body {
            font-family: "Lato", sans-serif;
          }
          
          .sidenav {
            height: 100%;
            width: 0;
            position: fixed;
            z-index: 1;
            top: 0;
            right: 0;
            background-color: #111;
            overflow-x: hidden;
            transition: 0.5s;
            padding-top: 60px;
          }
          
          .sidenav a {
            padding: 8px 8px 8px 32px;
            text-decoration: none;
            font-size: 25px;
            color: #818181;
            display: block;
            transition: 0.3s;
          }
          
          .sidenav a:hover {
            color: #f1f1f1;
          }
          
          .sidenav .closebtn {
            position: absolute;
            top: 0;
            right: 25px;
            font-size: 36px;
            margin-left: 50px;
          }
          
          #main {
            transition: margin-left .5s;
            padding: 16px;
          }
          
          @media screen and (max-height: 450px) {
            .sidenav {padding-top: 15px;}
            .sidenav a {font-size: 18px;}
          }
          </style>
    </head>
    <body onload="runWebGL();" style="background-color: rgb(105, 206, 236);" id="page-top">
        <!-- Navigation-->
        <nav class="navbar navbar-expand-lg navbar-light fixed-top py-3" id="mainNav">
            <div class="container">
                <a class="navbar-brand js-scroll-trigger" style="color: white;"  href="#page-top">Crossy Road</a>
            </div>
        </nav>
        
        <!-- Masthead-->
        <header class="masthead">
            <div class="container h-100">
                <div id="mySidenav" style="background-color: rgb(45, 161, 198); text-align: center;" class="sidenav">
                    <br/>
                    <br/>
                    <br/>
                    <br/>
                    <a style="color: whitesmoke;"  onclick="closeNav()"href="#">Personagem</a>
                    <a style="color: whitesmoke;" href="#">Mapa</a>
                    <a style="align-items: right;" onclick="closeNav()" href="#"> Close</a>
                </div>
                  <div id="main">
                    <span style="font-size:30px;cursor:pointer" onclick="openNav()">&#9776; Menu</span>
                  </div>
                <div class="row h-100 align-items-center justify-content-center text-center">
                    <div class="col-lg-8 align-self-baseline">
                        <canvas id="game-surface" style="border:1px solid #000000;" width="750" height="750"></canvas>
                    </div>
                </div>

                <div style="text-align: center">
                  
                  <p id="fps"> fps: </p>
              
                  <p>XX rotation: 
                    
                  <button id="XX-on-off-button">On / Off</button>
              
                    <button id="XX-direction-button">Change Direction</button>
              
                    <button id="XX-slower-button">Slower</button>
              
                    <button id="XX-faster-button">Faster</button>
              
                  </p>
                  
                  <p>YY rotation: 
                    
                  <button id="YY-on-off-button">On / Off</button>
              
                    <button id="YY-direction-button">Change Direction</button>
              
                    <button id="YY-slower-button">Slower</button>
              
                    <button id="YY-faster-button">Faster</button>
              
                  </p>
                  
                  <p>ZZ rotation: 
                    
                  <button id="ZZ-on-off-button">On / Off</button>
              
                    <button id="ZZ-direction-button">Change Direction</button>
              
                    <button id="ZZ-slower-button">Slower</button>
              
                    <button id="ZZ-faster-button">Faster</button>
              
                  </p>

                  <!-- <p>Read a 3D model from a <b>OBJ file</b>:
		
                    <input type="file" id="obj-file" name="file">
                    
                  </p> -->
                  
                  <p>Choose the <b>projection type</b>:
                  
                      <select id="projection-selection">
                    <option value="0">Orthogonal Projection</option>
                    <option value="1">Perspective Projection</option>
                      </select>
                      
                      </p>
                      
                      <p>Choose the <b>rendering mode</b>:
                  
                      <select id="rendering-mode-selection">
                    <option value="0">Filled Triangles</option>
                    <option value="1">Wireframe</option>
                    <option value="2">Vertices</option>
                      </select>
                              
                </div>


            </div>
        </header>   

    </body>
</html>
<script>
    function openNav() {
      document.getElementById("mySidenav").style.width = "250px";
      document.getElementById("main").style.marginLeft = "0";
    }
    
    function closeNav() {
      document.getElementById("mySidenav").style.width = "0";
      document.getElementById("main").style.marginLeft= "0";
    }
</script>




<!-- The vertex and fragment shaders.

NEW VERTEX SHADER!

The fragment shader is the same simple one. -->

<script id="shader-vs" type="x-shader/x-vertex">

  attribute vec3 vPosition;

  uniform mat4 uMVMatrix;

  uniform mat4 uPMatrix;
  
  varying vec4 fColor;
  
  // For the Phong Illumination Model - NEW
  
  attribute vec3 vNormal;
  
  uniform vec4 viewerPosition;

  // NEW - Array of lights
  
#define MAX_LIGHTS 5

uniform int numLights;

uniform struct Light {
  
  int isOn;

  vec4 position;
 
  mat4 lightSourceMatrix; // for animation

  vec3 intensities; //a.k.a the color of the light
 
  vec3 ambientIntensities;
    
} allLights[MAX_LIGHTS];
  
  // NEW - The material properties

uniform vec3 k_ambient;

uniform vec3 k_diffuse;

uniform vec3 k_specular;

  uniform float shininess;
      
  void main(void) {
  
  // To allow seeing the points drawn
  
  gl_PointSize = 5.0;
  
  // Just converting the (x,y,z) vertices to Homogeneous Coord.
  
  // And multiplying by the Projection and the Model-View matrix
  
      gl_Position = uPMatrix * uMVMatrix * vec4(vPosition, 1.0);
      
      // Phong Illumination Model
      
      // pos is vertex position after applying the global transformation
  
      vec3 pos = (uMVMatrix * vec4(vPosition, 1.0)).xyz;
  
  // NEW - ITERATING THROUGH ALL LIGHT SOURCES

  fColor = vec4(0.0, 0.0, 0.0, 0.0);	// To add all illumination components
   
  // THE FOR LOOP NEEDS A STOPPING CONSTANT VALUE
  
  for( int i = 0; i < MAX_LIGHTS; i++ ) 
  {
    if( i == numLights )
    
      break;
      
    // Switched off ?
    
    if( allLights[i].isOn == 0 )
    
      continue;
      
    // Ambient component is constant for each light source
      
    vec4 ambient = vec4( k_ambient * allLights[i].ambientIntensities, 1.0 );
   
    fColor += ambient;
  
         // vector from vertex position to light source
  
         vec3 L;
      
         // check for directional light
  
         if(allLights[i].position.w == 0.0) 
      
      L = normalize( (allLights[i].lightSourceMatrix * allLights[i].position).xyz );
      
         else 
      
        L = normalize( (allLights[i].lightSourceMatrix * allLights[i].position).xyz - pos );
    
     // Vector from the vertex position to the eye
  
     vec3 E;
  
     // The viewer is at the origin or at an indefinite distance
     // on the ZZ axis
  
     if(viewerPosition.w == 1.0) 
      
       // At the origin
    
       E = -normalize( pos );
      
         else 
      
       // On the ZZ axis
    
       E = vec3(0,0,1);
      
         // Halfway vector
  
         vec3 H = normalize( L + E );

         // Transform vertex normal into eye coordinates
  
         vec4 N = normalize( uMVMatrix * vec4(vNormal, 0.0));

         // Compute terms in the illumination equation
      
     // Diffuse component 
  
     float dotProductLN = L[0] * N[0] + L[1] * N[1] + L[2] * N[2]; 
  
         float cosNL = max( dotProductLN, 0.0 );
  
         vec4  diffuse = vec4( k_diffuse * cosNL * allLights[i].intensities, 1.0 );
      
         // Specular component

         float dotProductNH = N[0] * H[0] + N[1] * H[1] + N[2] * H[2]; 
  
     float cosNH = pow( max( dotProductNH, 0.0 ), shininess );
  
         vec4  specular = vec4( k_specular * cosNH * allLights[i].intensities, 1.0 );
  
         if( dotProductLN < 0.0 ) {

        specular = vec4(0.0, 0.0, 0.0, 1.0);
         } 

     // Adding the components
  
         fColor += diffuse + specular;
   }
}
  
</script>

<script id="shader-fs" type="x-shader/x-fragment">

precision mediump float;

varying vec4 fColor;

void main(void) {
  
  // Using the passed vertex color
  
  gl_FragColor = fColor;
}

</script>



<script type="text/javascript" src="app.js"></script>
<script type="text/javascript" src="initShaders.js"></script>
<script type="text/javascript" src="webgl-utils.js"></script>

<!-- Handling vectors and matrices -->

<script type="text/javascript" src="maths.js"></script>

<!-- Processing triangle mesh models -->

<script type="text/javascript" src="models.js"></script>

<!-- Creating the light sources -->

<script type="text/javascript" src="lightSources.js"></script>

<!-- Creating the scene models -->

<script type="text/javascript" src="sceneModels.js"></script>
